<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Resource Hub</title>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500&family=Comic+Neue:wght@700&family=IBM+Plex+Serif:wght@400;600&family=Playfair+Display:wght@500&family=Press+Start+2P&family=Poppins:wght@500&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/sortablejs@1.15.0/Sortable.min.js"></script>
<style>
:root{
  --bg:#f7f9fc;--ink:#0f172a;--muted:#64748b;--card:#ffffff;
  --accent:#0049b0;--accent-hover:#0063ff;--font:"Poppins",sans-serif;
}
/* ===== Theme families (light/dark) ===== */
body.theme-default-light{--bg:#f7f9fc;--ink:#0f172a;--muted:#64748b;--card:#ffffff;--accent:#0049b0;--accent-hover:#0063ff;--font:"Poppins",sans-serif;}
body.theme-default-dark{--bg:#0b1224;--ink:#e2e8f0;--muted:#9ca3af;--card:#141c33;--accent:#0098db;--accent-hover:#00bcd4;--font:"Poppins",sans-serif;}

body.theme-neon-light{
  --bg:#faf0ff;--ink:#260033;--muted:#660066;--card:#ffffff;
  --accent:#b300ff;--accent-hover:#ff33ff;--font:"Orbitron",sans-serif;
  background:linear-gradient(135deg,#fff0ff,#e0ccff);
}
body.theme-neon-dark{
  --bg:#08001a;--ink:#ff66ff;--muted:#00ffff;--card:#140033;
  --accent:#00ffff;--accent-hover:#ff33ff;--font:"Orbitron",sans-serif;
  background:linear-gradient(135deg,#08001a,#1a0033);
  animation:hue 20s infinite linear;
}

body.theme-vaporwave-light{
  --bg:linear-gradient(180deg,#ffe6f7,#e0b3ff);
  --ink:#3b0066;--muted:#a366ff;--card:rgba(255,255,255,0.8);
  --accent:#ff4df0;--accent-hover:#7f00ff;--font:"Comic Neue",cursive;
}
body.theme-vaporwave-dark{
  --bg:linear-gradient(180deg,#2b004d,#ff1ab3);
  --ink:#fff;--muted:#d98cff;--card:#1a002e;
  --accent:#ff80ff;--accent-hover:#ffff00;--font:"Comic Neue",cursive;
  animation:hue 25s infinite linear;
}

body.theme-retro-light{
  --bg:#fdf6e3;--ink:#3a2f0b;--muted:#7f8c8d;--card:#fffaf0;
  --accent:#e67e22;--accent-hover:#f39c12;--font:"IBM Plex Serif",serif;
}
body.theme-retro-dark{
  --bg:#1f1300;--ink:#f5deb3;--muted:#d2b48c;--card:#2b1900;
  --accent:#f39c12;--accent-hover:#ffcc00;--font:"IBM Plex Serif",serif;
}

body.theme-forest-light{
  --bg:#edf6ed;--ink:#08210d;--muted:#3f6e49;--card:#ffffff;
  --accent:#2f9e44;--accent-hover:#37b24d;--font:"Playfair Display",serif;
}
body.theme-forest-dark{
  --bg:#001a0b;--ink:#d9f7e3;--muted:#6ee7b7;--card:#002b17;
  --accent:#00ff88;--accent-hover:#66ffbb;--font:"Playfair Display",serif;
}

body.theme-cyberpunk-light{
  --bg:linear-gradient(135deg,#ffebee,#e3f2fd);
  --ink:#1a0033;--muted:#ff4081;--card:#fff;
  --accent:#e91e63;--accent-hover:#00bcd4;--font:"Press Start 2P",monospace;
}
body.theme-cyberpunk-dark{
  --bg:linear-gradient(135deg,#000014,#330033);
  --ink:#fffb00;--muted:#ff00ff;--card:#080033;
  --accent:#ff0080;--accent-hover:#00ffff;--font:"Press Start 2P",monospace;
  animation:hue 30s infinite linear;
}

body.theme-candy-light{
  --bg:#fff0f5;--ink:#4a154b;--muted:#cc6699;--card:#ffffff;
  --accent:#ff6fb5;--accent-hover:#ff8fc0;--font:"Poppins",sans-serif;
}
body.theme-candy-dark{
  --bg:#330026;--ink:#ffcce6;--muted:#ff80b3;--card:#4d0040;
  --accent:#ff66cc;--accent-hover:#ff99cc;--font:"Poppins",sans-serif;
}

/* animation for glowing themes */
@keyframes hue{from{filter:hue-rotate(0deg);}to{filter:hue-rotate(360deg);}}

/* ===== core UI ===== */
body{margin:0;color:var(--ink);font:15px/1.6 var(--font);transition:background .5s,color .3s;}
header{display:flex;justify-content:space-between;align-items:center;padding:14px 20px;background:var(--card);box-shadow:0 2px 8px rgba(0,0,0,0.2);position:sticky;top:0;z-index:10;}
h1{margin:0;font-weight:800;font-size:1.3rem;}
select,input[type=search]{border:none;border-radius:8px;padding:8px 12px;font:inherit;background:var(--card);box-shadow:0 1px 4px rgba(0,0,0,0.1);}
main{padding:20px;}
.card{background:var(--card);border-radius:10px;padding:18px;box-shadow:0 0 10px rgba(0,0,0,0.15);margin-bottom:1rem;}
a{color:var(--accent);text-decoration:none;font-weight:600;}
a:hover{text-decoration:underline;}
.editable{cursor:pointer;}
.editable:hover{background:rgba(0,0,0,0.05);}
.pill{display:inline-block;padding:3px 8px;border-radius:999px;font-size:12px;font-weight:600;margin-top:6px;}
.pill.int{background:#fee2e2;color:#7f1d1d;}
.pill.ext{background:#dcfce7;color:#065f46;}
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:16px;}
#splitLayout{display:flex;flex-wrap:wrap;gap:1rem;}
#splitLayout aside{flex:1 1 250px;max-width:280px;}
#splitLayout main{flex:3 1 600px;}
.kanban{display:flex;gap:1rem;overflow-x:auto;}
.kanCol{flex:1 1 260px;background:var(--card);border-radius:10px;padding:10px;min-width:250px;box-shadow:0 0 10px rgba(0,0,0,0.15);}
.kanItem{background:var(--bg);border-radius:8px;padding:8px 10px;margin-bottom:8px;cursor:grab;font-weight:600;}
.tree ul{list-style:none;margin-left:1rem;padding-left:0;}
.tree li{margin:.3rem 0;}
</style>
</head>

<body class="theme-default-light">
<header>
  <h1>Resource Hub</h1>
  <div>
    <input id="q" type="search" placeholder="Search..." />
    <select id="layout">
      <option value="grid">Grid</option>
      <option value="split">Split Dashboard</option>
      <option value="command">Command Palette</option>
      <option value="kanban">Kanban Board</option>
      <option value="explorer">Explorer Tree</option>
    </select>
    <select id="themeFamily">
      <option value="default">Default</option>
      <option value="neon">Neon</option>
      <option value="vaporwave">Vaporwave</option>
      <option value="retro">Retro</option>
      <option value="forest">Forest</option>
      <option value="cyberpunk">Cyberpunk</option>
      <option value="candy">Candy</option>
    </select>
    <select id="themeMode">
      <option value="light">Light</option>
      <option value="dark">Dark</option>
    </select>
  </div>
</header>

<main id="container"></main>

<div id="overlay" style="position:fixed;top:0;left:0;width:100%;height:100%;
display:none;align-items:flex-start;justify-content:center;
background:rgba(0,0,0,0.55);padding-top:100px;z-index:20;">
  <div style="background:var(--card);border-radius:10px;
    padding:12px;width:500px;max-width:90%;">
    <input id="cmdInput" placeholder="Search links..."
      style="width:100%;padding:8px;border:none;border-radius:6px;" />
    <ul id="cmdResults"
      style="list-style:none;padding:0;margin:10px 0 0;
      max-height:300px;overflow:auto;"></ul>
  </div>
</div>

<script>
let data=[];
const qEl=document.getElementById('q');
const container=document.getElementById('container');
const layoutSel=document.getElementById('layout');
const overlay=document.getElementById('overlay');
const cmdInput=document.getElementById('cmdInput');
const cmdResults=document.getElementById('cmdResults');
const themeFamily=document.getElementById('themeFamily');
const themeMode=document.getElementById('themeMode');

let family=localStorage.getItem('hub.themeFamily')||'default';
let mode=localStorage.getItem('hub.themeMode')||'light';
applyTheme();
themeFamily.value=family;themeMode.value=mode;

themeFamily.onchange=saveTheme;
themeMode.onchange=saveTheme;

function saveTheme(){
  family=themeFamily.value;
  mode=themeMode.value;
  localStorage.setItem('hub.themeFamily',family);
  localStorage.setItem('hub.themeMode',mode);
  applyTheme();
}
function applyTheme(){
  document.body.className='';
  document.body.classList.add(`theme-${family}-${mode}`);
  document.body.style.fontFamily=getComputedStyle(document.body).getPropertyValue('--font');
}

fetch('links.json').then(r=>r.json()).then(j=>{
  data=j.groups;
  const savedLayout=localStorage.getItem('hub.layout')||'split';
  layoutSel.value=savedLayout;
  render();
});
layoutSel.onchange=()=>{localStorage.setItem('hub.layout',layoutSel.value);render();};
qEl.oninput=()=>render();
document.addEventListener('keydown',e=>{
  if(e.ctrlKey&&e.key.toLowerCase()==='k'){e.preventDefault();openCommand();}
  if(e.key==='Escape')closeCommand();
});

function getCustomNotes(){return JSON.parse(localStorage.getItem('hub.customNotes')||'{}');}
function saveCustomNotes(o){localStorage.setItem('hub.customNotes',JSON.stringify(o));}

function render(){
  const mode=layoutSel.value;
  const q=(qEl.value||'').toLowerCase();
  const all=data.flatMap(g=>g.items).filter(i=>!q||i.title.toLowerCase().includes(q)||(i.notes||'').toLowerCase().includes(q));
  if(mode==='grid')return renderGrid(all);
  if(mode==='split')return renderSplit();
  if(mode==='command')return openCommand();
  if(mode==='kanban')return renderKanban();
  if(mode==='explorer')return renderExplorer();
}

function renderGrid(items){
  const custom=getCustomNotes();
  container.className='grid';
  container.innerHTML=items.map(i=>`
    <div class="card">
      <a href="${i.url}" target="_blank">${i.title}</a>
      <div class="editable" data-title="${i.title}">${custom[i.title]||i.notes||''}</div>
      <span class="pill ${i.vis==='internal'?'int':'ext'}">${i.vis}</span>
    </div>`).join('');
  enableEditing();
}

function renderSplit(){
  const custom=getCustomNotes();
  container.className='';
  const clicks=JSON.parse(localStorage.getItem('hub.clicks')||'{}');
  const asideList=`<aside><h3>Top Links</h3><ul>${
    Object.entries(clicks).sort((a,b)=>b[1]-a[1]).slice(0,5)
      .map(([t,c])=>`<li>${t} (${c})</li>`).join('')||'<li>No data yet</li>'
  }</ul></aside>`;
  const mainList=data.map(g=>`
    <div class="card">
      <h3>${g.title}</h3>
      <ul>${g.items.map(i=>`
        <li><a href="${i.url}" target="_blank">${i.title}</a> –
        <span class="editable" data-title="${i.title}">${custom[i.title]||i.notes||''}</span></li>`).join('')}
      </ul>
    </div>`).join('');
  container.innerHTML=`<div id="splitLayout">${asideList}<main>${mainList}</main></div>`;
  container.querySelectorAll('a').forEach(a=>{
    a.onclick=()=>{const t=a.textContent.trim();
      const clicks=JSON.parse(localStorage.getItem('hub.clicks')||'{}');
      clicks[t]=(clicks[t]||0)+1;
      localStorage.setItem('hub.clicks',JSON.stringify(clicks));
    };
  });
  enableEditing();
}

function openCommand(){
  overlay.style.display='flex';cmdInput.focus();cmdInput.value='';renderCmd();
}
function closeCommand(){overlay.style.display='none';cmdResults.innerHTML='';}
cmdInput.oninput=renderCmd;
function renderCmd(){
  const q=cmdInput.value.toLowerCase();
  const items=data.flatMap(g=>g.items).filter(i=>!q||i.title.toLowerCase().includes(q)||(i.notes||'').toLowerCase().includes(q));
  cmdResults.innerHTML=items.slice(0,25)
    .map(i=>`<li style="padding:8px;border-radius:6px;cursor:pointer;" data-url="${i.url}">${i.title}</li>`).join('');
}
cmdResults.onclick=e=>{
  if(e.target.dataset.url)window.open(e.target.dataset.url,'_blank');
  closeCommand();
};

function renderKanban(){
  container.className='kanban';
  container.innerHTML=data.map(g=>`
    <div class="kanCol" id="${g.id}">
      <h3>${g.title}</h3>
      <div class="kanBody">
        ${g.items.map(i=>`<div class="kanItem" data-url="${i.url}">${i.title}</div>`).join('')}
      </div>
    </div>`).join('');
  document.querySelectorAll('.kanItem').forEach(el=>el.onclick=()=>window.open(el.dataset.url,'_blank'));
  document.querySelectorAll('.kanBody').forEach(col=>new Sortable(col,{group:'shared',animation:150}));
}

function renderExplorer(){
  const custom=getCustomNotes();
  container.className='tree';
  container.innerHTML='<ul>'+data.map(g=>`
    <li><strong>${g.title}</strong>
      <ul>${g.items.map(i=>`
        <li><a href="${i.url}" target="_blank">${i.title}</a> –
        <span class="editable" data-title="${i.title}">${custom[i.title]||i.notes||''}</span></li>`).join('')}
      </ul>
    </li>`).join('')+'</ul>';
  enableEditing();
}

function enableEditing(){
  const edits=container.querySelectorAll('.editable');
  const custom=getCustomNotes();
  edits.forEach(el=>{
    el.onclick=()=>{
      const t=el.dataset.title;
      const current=custom[t]||el.textContent.trim();
      const input=document.createElement('input');
      input.value=current;input.style.width='90%';
      el.replaceWith(input);
      input.focus();
      input.onblur=()=>save();
      input.onkeydown=(e)=>{if(e.key==='Enter')save();}
      function save(){
        const newVal=input.value.trim();
        custom[t]=newVal;
        saveCustomNotes(custom);
        input.replaceWith(el);
        el.textContent=newVal;
      }
    };
  });
}
</script>
</body>
</html>
